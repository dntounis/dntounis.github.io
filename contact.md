---
layout: page
title: Contact
permalink: /contact/
description: Get in touch with Dimitris Ntounis - schedule a meeting or send a message.
---

<div class="contact-page">

<h2>Get In Touch</h2>

<div class="contact-info">
    <div class="contact-item contact-email">
        <i class="fas fa-envelope"></i>
        <div>
            <strong>Email</strong><br>
            <a href="mailto:dntounis@stanford.edu">dntounis@stanford.edu</a><br>
            <a href="mailto:dntounis@slac.stanford.edu">dntounis@slac.stanford.edu</a><br>
            <a href="mailto:dimitrios.ntounis@cern.ch">dimitrios.ntounis@cern.ch</a>
        </div>
    </div>
    <div class="contact-item contact-office">
        <i class="fas fa-building"></i>
        <div>
            <strong>Office</strong><br>
            Building 084, Room B235-A<br>
            <a href="https://vue.slac.stanford.edu/slac-visitor-map" target="_blank">SLAC National Accelerator Laboratory</a>
        </div>
    </div>
    <div class="contact-item contact-blog">
        <i class="fas fa-pen-nib"></i>
        <div>
            <strong>Blog</strong><br>
            <a href="https://dimitrisntounis.substack.com" target="_blank">Substack</a>
        </div>
    </div>
</div>

<h2 id="schedule-meeting">Schedule a Meeting</h2>

<div class="meeting-scheduler">
    <p>I'm available for one-hour meetings <strong>Monday through Friday, 7:00 PM - 8:00 PM Pacific Time</strong>. Select an available slot below to request a meeting.</p>

    <div class="availability-info">
        <i class="fas fa-clock"></i> All times shown in Pacific Time (PT)
    </div>

    <div id="booking-widget" class="booking-container">
        <!-- Week Navigation -->
        <div class="week-navigation">
            <button id="prev-week" class="week-nav-btn" aria-label="Previous week">
                <i class="fas fa-chevron-left"></i>
            </button>
            <span id="week-display" class="week-display"></span>
            <button id="next-week" class="week-nav-btn" aria-label="Next week">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>

        <!-- Calendar Grid -->
        <div id="calendar-grid" class="calendar-grid">
            <!-- Generated by JavaScript -->
        </div>

        <!-- Booking Form (shown when slot selected) -->
        <div id="booking-form-container" class="booking-form-container" style="display: none;">
            <h3>Book: <span id="selected-slot-display"></span></h3>
            <div class="booking-form">
                <div class="form-group">
                    <label for="visitor-name">Your Name <span class="required">*</span></label>
                    <input type="text" id="visitor-name" name="name" required placeholder="John Doe">
                </div>
                <div class="form-group">
                    <label for="visitor-email">Your Email <span class="required">*</span></label>
                    <input type="email" id="visitor-email" name="email" required placeholder="john.doe@example.com">
                </div>
                <div class="form-group">
                    <label for="visitor-affiliation">Affiliation</label>
                    <input type="text" id="visitor-affiliation" name="affiliation" placeholder="University / Organization">
                </div>
                <div class="form-group">
                    <label for="meeting-topic">Meeting Topic <span class="required">*</span></label>
                    <select id="meeting-topic" name="topic" required>
                        <option value="">Select a topic...</option>
                        <option value="Research Collaboration">Research Collaboration</option>
                        <option value="Prospective Student Inquiry">Prospective Student Inquiry</option>
                        <option value="Speaking Invitation">Speaking Invitation</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="message">Additional Notes</label>
                    <textarea id="message" name="message" rows="3" placeholder="Brief description of what you'd like to discuss..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" id="cancel-booking" class="btn-secondary">Cancel</button>
                    <button type="button" id="submit-booking" class="booking-submit">
                        <i class="fas fa-calendar-check"></i> Confirm Booking
                    </button>
                </div>
            </div>
        </div>

        <!-- Confirmation Message -->
        <div id="booking-confirmation" class="booking-confirmation" style="display: none;">
            <i class="fas fa-check-circle"></i>
            <h3>Meeting Confirmed!</h3>
            <div id="confirmation-message">
                <p>Thank you for booking. I'll receive a notification and confirm your meeting within 1 business day.</p>
            </div>
            <button type="button" id="book-another" class="btn-secondary">Book Another Meeting</button>
        </div>
    </div>
</div>

</div>

<script>
(function() {
    // Configuration
    // IMPORTANT: Replace this URL with your deployed Google Apps Script web app URL
    // See scripts/google-calendar-booking.gs for setup instructions
    const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxMmlwv9nfPLvpRtOdMTEe399Cgh-J5j2WzM_OFkaL59T7vOdksTSlDV3eMG1Q0X2M/exec"; // Your Apps Script deployment URL goes here

    const AVAILABLE_DAYS = [1, 2, 3, 4, 5]; // Monday to Friday
    const AVAILABLE_HOUR = 19; // 7:00 PM
    const SLOT_DURATION = 60; // minutes
    const BOOKING_EMAIL = 'dimitris.ntounis@gmail.com';
    const WEEKS_AHEAD = 4;

    // State
    let currentWeekOffset = 0;
    let selectedSlot = null;
    let bookedSlots = []; // Will be populated from Google Calendar
    let isLoading = true;
    let useCalendarIntegration = !!APPS_SCRIPT_URL;

    // DOM Elements
    const calendarGrid = document.getElementById('calendar-grid');
    const weekDisplay = document.getElementById('week-display');
    const prevWeekBtn = document.getElementById('prev-week');
    const nextWeekBtn = document.getElementById('next-week');
    const bookingFormContainer = document.getElementById('booking-form-container');
    const selectedSlotDisplay = document.getElementById('selected-slot-display');
    const bookingConfirmation = document.getElementById('booking-confirmation');

    // Fetch busy slots from Google Calendar via Apps Script
    async function fetchBusySlots() {
        if (!useCalendarIntegration) {
            // Fallback to localStorage when Apps Script not configured
            bookedSlots = JSON.parse(localStorage.getItem('bookedSlots') || '[]');
            isLoading = false;
            return;
        }

        try {
            const startDate = formatDateKey(new Date());
            const endDate = formatDateKey(getDateNDaysFromNow(WEEKS_AHEAD * 7));

            const response = await fetch(`${APPS_SCRIPT_URL}?start=${startDate}&end=${endDate}`, {
                method: 'GET',
                redirect: 'follow',
                headers: {
                    'Accept': 'application/json'
                }
            });

            // Google Apps Script may redirect - check if we got a valid response
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            const text = await response.text();

            // Try to parse as JSON
            try {
                const data = JSON.parse(text);
                if (data.success) {
                    bookedSlots = data.busySlots || [];
                    console.log('Calendar data loaded successfully');
                } else {
                    console.error('API returned error:', data.error);
                    bookedSlots = JSON.parse(localStorage.getItem('bookedSlots') || '[]');
                }
            } catch (parseError) {
                console.error('Failed to parse response:', text.substring(0, 200));
                bookedSlots = JSON.parse(localStorage.getItem('bookedSlots') || '[]');
            }
        } catch (error) {
            console.error('Error fetching calendar data:', error);
            // Fallback to localStorage
            bookedSlots = JSON.parse(localStorage.getItem('bookedSlots') || '[]');
        }
        isLoading = false;
    }

    function getDateNDaysFromNow(n) {
        const date = new Date();
        date.setDate(date.getDate() + n);
        return date;
    }

    // Utility functions
    function getWeekStart(offset = 0) {
        const today = new Date();
        const dayOfWeek = today.getDay();
        const diff = today.getDate() - dayOfWeek + (dayOfWeek === 0 ? -6 : 1) + (offset * 7);
        const weekStart = new Date(today.setDate(diff));
        weekStart.setHours(0, 0, 0, 0);
        return weekStart;
    }

    function formatDate(date) {
        return date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
    }

    function formatDateKey(date) {
        return date.toISOString().split('T')[0];
    }

    function isSlotBooked(dateKey) {
        return bookedSlots.includes(dateKey);
    }

    function isPastDate(date) {
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        return date < today;
    }

    function isToday(date) {
        const today = new Date();
        return date.toDateString() === today.toDateString();
    }

    // Render calendar
    function renderCalendar() {
        const weekStart = getWeekStart(currentWeekOffset);
        const weekEnd = new Date(weekStart);
        weekEnd.setDate(weekEnd.getDate() + 6);

        // Update week display
        weekDisplay.textContent = `${formatDate(weekStart)} - ${formatDate(weekEnd)}`;

        // Disable prev button if showing current week
        prevWeekBtn.disabled = currentWeekOffset <= 0;
        nextWeekBtn.disabled = currentWeekOffset >= WEEKS_AHEAD - 1;

        // Generate calendar grid
        let html = '';
        for (let i = 0; i < 7; i++) {
            const date = new Date(weekStart);
            date.setDate(date.getDate() + i);
            const dateKey = formatDateKey(date);
            const dayNum = date.getDay();
            const isAvailableDay = AVAILABLE_DAYS.includes(dayNum);
            const isPast = isPastDate(date);
            const isBooked = isSlotBooked(dateKey);
            const isTodayDate = isToday(date);

            let slotClass = 'calendar-slot';
            let slotContent = '';
            let clickable = false;

            if (!isAvailableDay) {
                slotClass += ' unavailable';
                slotContent = '<span class="slot-status">Not available</span>';
            } else if (isPast) {
                slotClass += ' past';
                slotContent = '<span class="slot-status">Past</span>';
            } else if (isBooked) {
                slotClass += ' booked';
                slotContent = '<span class="slot-status">Booked</span>';
            } else {
                slotClass += ' available';
                slotContent = `<span class="slot-time">7:00 PM - 8:00 PM</span>
                               <span class="slot-action">Click to book</span>`;
                clickable = true;
            }

            html += `
                <div class="calendar-day ${isTodayDate ? 'today' : ''}">
                    <div class="day-header">
                        <span class="day-name">${date.toLocaleDateString('en-US', { weekday: 'short' })}</span>
                        <span class="day-date">${date.getDate()}</span>
                    </div>
                    <div class="${slotClass}" ${clickable ? `data-date="${dateKey}" role="button" tabindex="0"` : ''}>
                        ${slotContent}
                    </div>
                </div>
            `;
        }
        calendarGrid.innerHTML = html;

        // Add click handlers to available slots
        document.querySelectorAll('.calendar-slot.available').forEach(slot => {
            slot.addEventListener('click', () => selectSlot(slot.dataset.date));
            slot.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    selectSlot(slot.dataset.date);
                }
            });
        });
    }

    function selectSlot(dateKey) {
        selectedSlot = dateKey;
        const date = new Date(dateKey + 'T19:00:00');
        selectedSlotDisplay.textContent = `${formatDate(date)}, 7:00 PM - 8:00 PM PT`;
        bookingFormContainer.style.display = 'block';
        bookingFormContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function cancelBooking() {
        selectedSlot = null;
        bookingFormContainer.style.display = 'none';
        // Clear form
        document.getElementById('visitor-name').value = '';
        document.getElementById('visitor-email').value = '';
        document.getElementById('visitor-affiliation').value = '';
        document.getElementById('meeting-topic').value = '';
        document.getElementById('message').value = '';
    }

    async function submitBooking() {
        const name = document.getElementById('visitor-name').value.trim();
        const email = document.getElementById('visitor-email').value.trim();
        const affiliation = document.getElementById('visitor-affiliation').value.trim();
        const topic = document.getElementById('meeting-topic').value;
        const message = document.getElementById('message').value.trim();

        // Validation
        if (!name || !email || !topic) {
            alert('Please fill in all required fields.');
            return;
        }

        // Email validation
        if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
            alert('Please enter a valid email address.');
            return;
        }

        const submitBtn = document.getElementById('submit-booking');
        const originalBtnText = submitBtn.innerHTML;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Booking...';
        submitBtn.disabled = true;

        // Format date for display
        const date = new Date(selectedSlot + 'T19:00:00');
        const dateStr = date.toLocaleDateString('en-US', {
            weekday: 'long',
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });

        if (useCalendarIntegration) {
            // Use Google Apps Script for real calendar integration
            try {
                const response = await fetch(APPS_SCRIPT_URL, {
                    method: 'POST',
                    redirect: 'follow',
                    headers: {
                        'Content-Type': 'text/plain', // Apps Script works better with text/plain
                    },
                    body: JSON.stringify({
                        date: selectedSlot,
                        name: name,
                        email: email,
                        affiliation: affiliation,
                        topic: topic,
                        message: message
                    })
                });

                const text = await response.text();
                let result;

                try {
                    result = JSON.parse(text);
                } catch (parseError) {
                    console.error('Failed to parse booking response:', text.substring(0, 200));
                    throw new Error('Invalid response from server');
                }

                if (result.success) {
                    // Update local state
                    bookedSlots.push(selectedSlot);
                    localStorage.setItem('bookedSlots', JSON.stringify(bookedSlots)); // Also save locally as backup

                    // Show confirmation
                    bookingFormContainer.style.display = 'none';
                    document.getElementById('confirmation-message').innerHTML = `
                        <p>Your meeting has been confirmed and added to the calendar.</p>
                        <p>A calendar invitation has been sent to <strong>${email}</strong>.</p>
                    `;
                    bookingConfirmation.style.display = 'block';
                    renderCalendar();
                } else {
                    alert(result.error || 'Failed to book meeting. Please try again.');
                    submitBtn.innerHTML = originalBtnText;
                    submitBtn.disabled = false;
                }
            } catch (error) {
                console.error('Booking error:', error);
                alert('Failed to connect to booking system. Please try again or contact directly via email.');
                submitBtn.innerHTML = originalBtnText;
                submitBtn.disabled = false;
            }
        } else {
            // Fallback to mailto when Apps Script not configured
            const subject = encodeURIComponent(`Meeting Request: ${topic} - ${name} (${dateStr})`);
            const body = encodeURIComponent(
                `New Meeting Booking from Website\n` +
                `================================\n\n` +
                `Date: ${dateStr}\n` +
                `Time: 7:00 PM - 8:00 PM Pacific Time\n\n` +
                `Name: ${name}\n` +
                `Email: ${email}\n` +
                `Affiliation: ${affiliation || 'Not specified'}\n` +
                `Topic: ${topic}\n\n` +
                `Additional Notes:\n${message || 'None'}\n\n` +
                `---\n` +
                `Please confirm this meeting by replying to ${email}`
            );

            // Mark slot as booked locally
            bookedSlots.push(selectedSlot);
            localStorage.setItem('bookedSlots', JSON.stringify(bookedSlots));

            // Open email client
            window.location.href = `mailto:${BOOKING_EMAIL}?subject=${subject}&body=${body}`;

            // Show confirmation
            bookingFormContainer.style.display = 'none';
            bookingConfirmation.style.display = 'block';
            renderCalendar();
        }
    }

    function bookAnother() {
        bookingConfirmation.style.display = 'none';
        cancelBooking();
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Event listeners
    prevWeekBtn.addEventListener('click', () => {
        if (currentWeekOffset > 0) {
            currentWeekOffset--;
            renderCalendar();
        }
    });

    nextWeekBtn.addEventListener('click', () => {
        if (currentWeekOffset < WEEKS_AHEAD - 1) {
            currentWeekOffset++;
            renderCalendar();
        }
    });

    document.getElementById('cancel-booking').addEventListener('click', cancelBooking);
    document.getElementById('submit-booking').addEventListener('click', submitBooking);
    document.getElementById('book-another').addEventListener('click', bookAnother);

    // Initialize - fetch calendar data then render
    async function initialize() {
        // Show loading state
        calendarGrid.innerHTML = '<div class="calendar-loading"><i class="fas fa-spinner fa-spin"></i> Loading availability...</div>';

        // Fetch busy slots from Google Calendar
        await fetchBusySlots();

        // Render calendar with real availability
        renderCalendar();
    }

    initialize();
})();
</script>

<style>
.contact-page {
    max-width: 800px;
    margin: 0 auto;
}

.contact-info {
    display: grid;
    grid-template-columns: 2fr 1.5fr 1fr;
    gap: 1.5rem;
    margin: 2rem 0 3rem;
}

@media (max-width: 900px) {
    .contact-info {
        grid-template-columns: 1fr 1fr;
    }
    .contact-email {
        grid-column: span 2;
    }
}

@media (max-width: 600px) {
    .contact-info {
        grid-template-columns: 1fr;
    }
    .contact-email {
        grid-column: span 1;
    }
}

.contact-item {
    display: flex;
    gap: 1rem;
    align-items: flex-start;
    padding: 1.5rem;
    background: #f8f9fa;
    border-radius: 8px;
    border-left: 4px solid #8C1515;
    overflow: hidden;
}

.contact-item i {
    font-size: 1.5rem;
    color: #8C1515;
    margin-top: 0.25rem;
    flex-shrink: 0;
}

.contact-item > div {
    min-width: 0;
    overflow: hidden;
}

.contact-item a {
    color: #8C1515;
    text-decoration: none;
    word-break: break-all;
    font-size: 0.9rem;
}

.contact-item a:hover {
    text-decoration: underline;
}

.availability-info {
    background: #e8f4fd;
    padding: 0.75rem 1rem;
    border-radius: 6px;
    color: #1565c0;
    font-size: 0.9rem;
    margin-bottom: 1.5rem;
}

.availability-info i {
    margin-right: 0.5rem;
}

/* Week Navigation */
.week-navigation {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.week-nav-btn {
    background: #f0f0f0;
    border: none;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
}

.week-nav-btn:hover:not(:disabled) {
    background: #8C1515;
    color: white;
}

.week-nav-btn:disabled {
    opacity: 0.3;
    cursor: not-allowed;
}

.week-display {
    font-weight: 600;
    font-size: 1.1rem;
    min-width: 250px;
    text-align: center;
}

/* Calendar Grid */
.calendar-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 0.5rem;
    margin-bottom: 2rem;
}

@media (max-width: 768px) {
    .calendar-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

.calendar-day {
    text-align: center;
}

.calendar-day.today .day-header {
    background: #8C1515;
    color: white;
}

.day-header {
    background: #f5f5f5;
    padding: 0.5rem;
    border-radius: 6px 6px 0 0;
}

.day-name {
    display: block;
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.day-date {
    display: block;
    font-size: 1.25rem;
    font-weight: 600;
}

.calendar-slot {
    padding: 1rem 0.5rem;
    border-radius: 0 0 6px 6px;
    min-height: 60px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 0.25rem;
}

.calendar-slot.available {
    background: #e8f5e9;
    border: 2px solid #4caf50;
    cursor: pointer;
    transition: all 0.2s ease;
}

.calendar-slot.available:hover {
    background: #c8e6c9;
    transform: scale(1.02);
}

.calendar-slot.available:focus {
    outline: 2px solid #8C1515;
    outline-offset: 2px;
}

.calendar-slot.booked {
    background: #ffebee;
    border: 2px solid #ef5350;
}

.calendar-slot.unavailable {
    background: #f5f5f5;
    color: #999;
}

.calendar-slot.past {
    background: #eeeeee;
    color: #999;
}

.slot-time {
    font-weight: 600;
    font-size: 0.85rem;
    color: #2e7d32;
}

.slot-action {
    font-size: 0.75rem;
    color: #4caf50;
}

.slot-status {
    font-size: 0.8rem;
    color: inherit;
}

/* Booking Form Container */
.booking-form-container {
    background: #f8f9fa;
    padding: 2rem;
    border-radius: 8px;
    margin-top: 1rem;
    border: 2px solid #8C1515;
}

.booking-form-container h3 {
    margin-top: 0;
    color: #8C1515;
}

.form-actions {
    display: flex;
    gap: 1rem;
    margin-top: 1.5rem;
}

.btn-secondary {
    padding: 0.75rem 1.5rem;
    background: #f0f0f0;
    color: #333;
    border: 2px solid #ddd;
    border-radius: 6px;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.2s ease;
}

.btn-secondary:hover {
    background: #e0e0e0;
    border-color: #ccc;
}

/* Dark mode */
[data-theme="dark"] .contact-item {
    background: #161b22;
    border-left-color: #58a6ff;
}

[data-theme="dark"] .contact-item i {
    color: #58a6ff;
}

[data-theme="dark"] .contact-item a {
    color: #58a6ff;
}

[data-theme="dark"] .availability-info {
    background: #0d2137;
    color: #58a6ff;
}

[data-theme="dark"] .week-nav-btn {
    background: #21262d;
    color: #c9d1d9;
}

[data-theme="dark"] .week-nav-btn:hover:not(:disabled) {
    background: #58a6ff;
    color: #0d1117;
}

[data-theme="dark"] .day-header {
    background: #21262d;
    color: #c9d1d9;
}

[data-theme="dark"] .calendar-day.today .day-header {
    background: #58a6ff;
    color: #0d1117;
}

[data-theme="dark"] .calendar-slot.available {
    background: #0d2818;
    border-color: #238636;
}

[data-theme="dark"] .calendar-slot.available:hover {
    background: #133929;
}

[data-theme="dark"] .slot-time {
    color: #3fb950;
}

[data-theme="dark"] .slot-action {
    color: #238636;
}

[data-theme="dark"] .calendar-slot.booked {
    background: #2d1b1b;
    border-color: #f85149;
}

[data-theme="dark"] .calendar-slot.unavailable,
[data-theme="dark"] .calendar-slot.past {
    background: #161b22;
    color: #8b949e;
}

[data-theme="dark"] .booking-form-container {
    background: #161b22;
    border-color: #58a6ff;
}

[data-theme="dark"] .booking-form-container h3 {
    color: #58a6ff;
}

[data-theme="dark"] .btn-secondary {
    background: #21262d;
    color: #c9d1d9;
    border-color: #30363d;
}

[data-theme="dark"] .btn-secondary:hover {
    background: #30363d;
}

/* Loading state */
.calendar-loading {
    grid-column: 1 / -1;
    text-align: center;
    padding: 3rem;
    color: #666;
    font-size: 1rem;
}

.calendar-loading i {
    margin-right: 0.5rem;
    color: #8C1515;
}

[data-theme="dark"] .calendar-loading {
    color: #8b949e;
}

[data-theme="dark"] .calendar-loading i {
    color: #58a6ff;
}

/* Confirmation styling */
.booking-confirmation {
    text-align: center;
    padding: 2rem;
    background: #e8f5e9;
    border-radius: 8px;
    border: 2px solid #4caf50;
}

.booking-confirmation i {
    font-size: 3rem;
    color: #4caf50;
    margin-bottom: 1rem;
}

.booking-confirmation h3 {
    color: #2e7d32;
    margin-bottom: 1rem;
}

.booking-confirmation p {
    margin-bottom: 0.5rem;
    color: #333;
}

[data-theme="dark"] .booking-confirmation {
    background: #0d2818;
    border-color: #238636;
}

[data-theme="dark"] .booking-confirmation i {
    color: #3fb950;
}

[data-theme="dark"] .booking-confirmation h3 {
    color: #3fb950;
}

[data-theme="dark"] .booking-confirmation p {
    color: #c9d1d9;
}
</style>
